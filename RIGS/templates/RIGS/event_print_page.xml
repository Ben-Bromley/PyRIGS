<setNextFrame name="main"/>
<nextFrame/>

<h1><b>N{{ object.pk|stringformat:"05d" }}:</b> '{{ object.name }}'<small></small></h1>

<para style="style.event_description">
<b>{{object.start_date|date:"D jS N Y"}}</b>
</para>
<keepInFrame maxHeight="30">
<para style="style.event_description">
{{ object.description|default_if_none:""|linebreaks }}
    </para>
</keepInFrame>
<spacer length="15"/>
<blockTable style="eventSpecifics" colWidths="165,165,165">
    <tr>
        <td leftPadding="0">
                <h2>Hirer</h2>
                <h3>{{ object.person.name }}</h3>
                <h3>{{ object.organisation.name|default_if_none:"" }}</h3>
                
                <keepInFrame>
                    {% if object.person.phone %}
                        <para style="specific_description">{{ object.person.phone }}</para>
                    {% elif object.organisation.phone %}
                        <para style="specific_description">{{ object.organisation.phone }}</para>
                    {% endif %}
                </keepInFrame>
                <keepInFrame>
                    {% if object.person.email %}
                        <para style="specific_description">{{ object.person.email }}</para>
                    {% elif object.organisation.email %}
                        <para style="specific_description">{{ object.organisation.email }}</para>
                    {% endif %}
                </keepInFrame>
        </td>
        <td>
            <h2>Venue</h2>
            <h3>{{ object.venue.name }}</h3>
            <keepInFrame>
            <para style="specific_description">{{ object.venue.address|default_if_none:""|linebreaks }}</para>
            </keepInFrame>
        </td>
        <td rightPadding="0">
            
                <h2>Timings</h2>
                <blockTable style="eventDetails" colWidths="55,75">
                <tr>
                    <td leftPadding="0" topPadding="0"><h3>Start</h3></td>
                    <td>
                        <para style="times">{{ object.start_time|time:"H:i" }}
                            {{ object.start_date|date:"d/m/Y" }}
                        </para>
                    </td>
                </tr>
                <tr>
                    <td leftPadding="0"><h3>End</h3></td>
                    <td>
                        <para style="times">{{ object.end_time|default_if_none:""|time:"H:i" }}
                            {{ object.end_date|date:"d/m/Y" }}
                        </para>
                    </td>
                </tr>
                {% if object.access_at %}
                <tr>
                    <td leftPadding="0"><h3>Access</h3></td>
                    <td>
                        <para style="times">{{ object.access_at|time:"H:i" }}
                            {{ object.access_at|date:"d/m/Y" }}
                        </para>
                    </td>
                </tr>
                {% endif %}
                </blockTable>
        </td>

    </tr>
</blockTable>

<spacer length="15"/>

<setNextTemplate name="Main"/>


<blockTable style="itemTable" colWidths="300,80,35,80">
<tr>
    {# Bold tags need to be in a para in order to render in reportlab #}
    <td>
        <para>
            <b>Item</b>
        </para>
    </td>
    <td>
        <para>
            <b>Price</b>
        </para>
    </td>
    <td>
        <para>
            <b>Qty</b>
        </para>
    </td>
    <td>
        <para>
            <b>Sub-total</b>
        </para>
    </td>
</tr>
{% for item in object.items.all %}
    <tr>
        <td>
            <para>{{ item.name }}
                {% if item.description %}
                    </para>
                    <para style="item_description">
                    <em>{{ item.description|linebreaks }}</em>
                    </para>
                    <para>
                {% endif %}
            </para>
        </td>
        <td>£ {{ item.cost|floatformat:2 }}</td>
        <td>{{ item.quantity }}</td>
        <td>£ {{ item.total_cost|floatformat:2 }}</td>
    </tr>
{% endfor %}
</blockTable>
<keepTogether>
    <blockTable style="totalTable" colWidths="300,115,80">
    <tr>
        <td></td>
        <td>Total (ex. VAT)</td>
        <td>£ {{ object.sum_total|floatformat:2 }}</td>
    </tr>
    <tr>
        <td>VAT Registration Number: 116252989</td>
        <td>VAT @ {{ object.vat_rate.as_percent|floatformat:2 }}%</td>
        <td>£ {{ object.vat|floatformat:2 }}</td>
    </tr>
    <tr>
        <td>
            <para>
                <b>The full hire fee is payable at least 10 days before the event.</b>
            </para>
        </td>
        <td>
            <para>
                <b>Total</b>
            </para>
        </td>
        <td>
            <para>
                <b>£ {{ object.total|floatformat:2 }}</b>
            </para>
        </td>
    </tr>
    </blockTable>
</keepTogether>
<keepTogether>
<blockTable style="infoTable">
<tr>
    <td>
        <para>Bookings will
            <b>not</b>
            be confirmed until payment is received and the contract is signed.
        </para>
    </td>
</tr>
<tr>
    <td>24 Hour Emergency Contacts: 07825 065681 or 07825 065678</td>
</tr>
</blockTable>
</keepTogether>
<spacer length="15"/>
<keepTogether>

<para style="blockPara">
<b>To be signed on booking:</b>
</para>
{% if object.organisation.union_account %}
    <para style="blockPara">
    <i>
        I agree that am authorised to sign this invoice. I agree that I am the President/Treasurer of the hirer, or
        that I have provided written permission from either the President or Treasurer of the hirer stating that I can
        sign for this invoice.
    </i>
    </para>
    <para style="blockPara">
    <i>
        I have read, understood and fully accepted the current conditions of hire. I agree to return any dry hire
        items to TEC PA &amp; Lighting in the same condition at the end of the hire period.
    </i>
    </para>

    <para style="blockPara">
    <b>
        Conditions of hire available on request or on the TEC PA &amp; Lighting website. E&amp;OE
    </b>
    </para>

    <para style="blockPara">
    Please return this form directly to TEC PA &amp; Lighting and not the Students' Union Finance Department.
    </para>

    <blockTable style="signatureTable" colWidths="70,100,325">
    <tr>
        <td>Account Code</td>
        <td></td>
        <td></td>
    </tr>
    </blockTable>

{% else %}
    <para style="blockPara">
    <i>
        I, the hirer, have read, understand and fully accept the current conditions of hire. This document forms a
        binding contract between TEC PA &amp; Lighting and the hirer, the aforementioned conditions of hire forming
        an integral part of it.
    </i>
    </para>

    <para style="blockPara">
    <b>
        Conditions of hire available on request or on the TEC PA &amp; Lighting website. E&amp;OE
    </b>
    </para>

    {% include "RIGS/event_print_signature.xml" %}
    <spacer length="10"/>
    <para style="blockPara">
    <b>To be signed on the day of the event/hire:</b>
    </para>
    <para style="blockPara">
    <i>
        I, the hirer, have received the goods/services as requested and in good order. I agree to return any dry hire
        items to TEC PA &amp; Lighting in a similar condition at the end of the hire period.
    </i>
    </para>
{% endif %}

{% include "RIGS/event_print_signature.xml" %}
</keepTogether>
<namedString id="lastPage"><pageNumber/></namedString>